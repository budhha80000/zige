<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>字格 ZiGe | Markdown 编辑器 |by 饸饹随笔</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <!-- Font Awesome 图标库 (更稳定的选择) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>字格 ZiGe <span class="brand-label">by 饸饹随笔</span></h1>
            <div class="toolbar">
                <input type="file" id="fileInput" accept=".md,.markdown" style="display: none;">
                <button id="uploadBtn" title="上传Markdown文件"><i class="fas fa-upload"></i> 打开</button>
                <button id="pasteBtn" title="粘贴内容"><i class="fas fa-paste"></i> 粘贴</button>
                <button id="copyBtn" title="复制内容"><i class="fas fa-copy"></i> 复制</button>
                <button id="resetBtn" title="清空编辑器内容"><i class="fas fa-trash-alt"></i> 清空</button>
                <button id="undoBtn" title="撤销"><i class="fas fa-undo"></i> 撤销</button>
                <button id="redoBtn" title="重做"><i class="fas fa-redo"></i> 重做</button>
                <button id="exportPdfBtn" title="导出为PDF" disabled><i class="fas fa-file-pdf"></i> 导出 PDF</button>
                <button id="exportHtmlBtn" title="导出为HTML"><i class="fab fa-html5"></i> 导出 HTML</button>
                <button id="exportPngBtn" title="导出为PNG图片" class="primary"><i class="fas fa-image"></i> 图片生成设置</button>
            </div>
        </header>
        
        <div class="editor-container">
            <div class="editor-panel">
                <h2>编辑器</h2>
                <div class="editor-actions">
                    <!-- 总是显示的按钮组 -->
                    <div class="always-visible">
                        <select id="fontFamilySelect" title="字体">
                            <option value="'Source Han Sans SC', 'Source Han Sans CN', 'Source Han Sans', 'Noto Sans CJK SC', sans-serif" selected>思源黑体 (默认)</option>
                            <option value="'Source Han Serif SC', 'Source Han Serif CN', 'Source Han Serif', 'Songti SC', serif">思源宋体</option>
                            <option value="'阿里妈妈刀隶体', sans-serif">阿里妈妈刀隶体</option>
                            <option value="'阿里妈妈东方大楷', serif">阿里妈妈东方大楷</option>
                            <option value="'阿里妈妈数黑体', sans-serif">阿里妈妈数黑体</option>
                            <option value="'爱点风雅黑', sans-serif">爱点风雅黑</option>
                            <option value="'钉钉进步体', sans-serif">钉钉进步体</option>
                            <option value="'得意黑', sans-serif">得意黑</option>
                            <option value="'鸿雷拙书简体', sans-serif">鸿雷拙手简体</option>
                            <option value="'汇文明朝体', serif">汇文明朝体</option>
                            <option value="'朱雀仿宋', serif">朱雀仿宋</option>
                        </select>
                        <select id="fontWeightSelect" title="字重">
                            <option value="">字重</option>
                            <option value="200">Extralight</option>
                            <option value="300">Light</option>
                            <option value="400" selected>Regular</option>
                            <option value="500">Medium</option>
                            <option value="700">Bold</option>
                            <option value="900">Heavy</option>
                        </select>
                        <select id="fontSizeSelect" title="字号">
                            <option value="">字号</option>
                            <option value="14px">小</option>
                            <option value="16px">中</option>
                            <option value="20px">大</option>
                            <option value="28px">特大</option>
                        </select>
                        <button id="toggleActionsBtn" title="展开/收起编辑工具"><i class="fas fa-ellipsis-h"></i></button>
                    </div>
                    
                    <!-- 默认收起的按钮组 -->
                    <div class="toggleable-actions">
                        <button id="boldBtn" title="粗体"><i class="fas fa-bold"></i></button>
                        <button id="italicBtn" title="斜体"><i class="fas fa-italic"></i></button>
                        <button id="headingBtn" title="标题"><i class="fas fa-heading"></i></button>
                        <button id="heading2Btn" title="二级标题"><i class="fas fa-heading"></i>2</button>
                        <button id="heading3Btn" title="三级标题"><i class="fas fa-heading"></i>3</button>
                        <button id="codeBtn" title="行内代码"><i class="fas fa-code"></i></button>
                        <button id="codeBlockBtn" title="代码块"><i class="fas fa-greater-than"></i></button>
                        <button id="listBtn" title="无序列表"><i class="fas fa-list-ul"></i></button>
                        <button id="orderedListBtn" title="有序列表"><i class="fas fa-list-ol"></i></button>
                        <button id="taskListBtn" title="任务列表"><i class="far fa-check-square"></i></button>
                        <button id="linkBtn" title="链接"><i class="fas fa-link"></i></button>
                        <button id="imageBtn" title="图片"><i class="fas fa-image"></i></button>
                        <button id="tableBtn" title="表格"><i class="fas fa-table"></i></button>
                        <button id="blockquoteBtn" title="引用"><i class="fas fa-quote-left"></i></button>
                        <button id="horizontalRuleBtn" title="分隔线"><i class="fas fa-minus"></i></button>
                        <button id="strikethroughBtn" title="删除线"><i class="fas fa-strikethrough"></i></button>
                    </div>
                </div>
                <textarea id="editor" placeholder="在这里输入 Markdown..."></textarea>
                <div class="status-bar">
                    <span id="charCount">字符数: 0</span>
                    <span id="wordCount">单词数: 0</span>
                </div>
            </div>
            
            <div class="preview-panel">
                <h2>
                    预览
                    <button class="mobile-download-btn" id="mobileDownloadBtn" title="下载预览图">📱 下载</button>
                </h2>
                <div id="preview"></div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>字格 ZiGe | Markdown 编辑器 v13.0  2026 <br> by 饸饹随笔 由 囫囵拓扑 驱动</p>
        <p><a href="#" onclick="openLicenseModal(); return false;" style="color: inherit; text-decoration: underline;">MIT License</a></p>
        <div class="privacy-footer">
            <button id="privacyLink" title="隐私条款" class="privacy-footer-icon"><i class="fas fa-shield-alt"></i></button>
            <span class="privacy-footer-text">隐私条款</span>
        </div>
    </footer>
    
    <!-- 图片生成配置模态框 -->
    <div id="imageConfigModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>图片生成配置</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="config-section">
                    <label>类型：</label>
                    <div class="device-options">
                        <button class="device-option active" data-device="phone">📱 手机</button>
                        <button class="device-option" data-device="tablet">📱 平板</button>
                        <button class="device-option" data-device="desktop">🖥️ 桌面</button>
                    </div>
                </div>
                <div class="config-section">
                    <label>配色：</label>
                    <div class="background-options">
                        <div class="color-option active" data-background="white" data-text-color="#333333" style="background-color: white; border: 1px solid #ccc;">默认</div>
                        <div class="color-option" data-background="#1a1a1a" data-text-color="#ffffff" style="background-color: #1a1a1a; border: 1px solid #ccc;">零度炫黑</div>
                        <div class="color-option" data-background="#f5f5f5" data-text-color="#333333" style="background-color: #f5f5f5; border: 1px solid #ccc;">灰度象限</div>
                        <div class="color-option" data-background="#f0f0ff" data-text-color="#333399" style="background-color: #f0f0ff; border: 1px solid #ccc;">三色棱镜</div>
                        <div class="color-option" data-background="#f5f0e6" data-text-color="#8b4513" style="background-color: #f5f0e6; border: 1px solid #ccc;">霜林空境</div>
                        <div class="color-option" data-background="#f0f5f9" data-text-color="#1e3a5f" style="background-color: #f0f5f9; border: 1px solid #ccc;">海雾肌理</div>
                        <div class="color-option" data-background="#e6f7ff" data-text-color="#006699" style="background-color: #e6f7ff; border: 1px solid #ccc;">冷调青霭</div>
                        <div class="color-option" data-background="#f7f3f0" data-text-color="#8c7b72" style="background-color: #f7f3f0; border: 1px solid #ccc;">莫兰迪序章</div>
                    </div>
                </div>

                <div class="config-actions">
                    <button id="generateImageButton">生成图片并下载</button>
                </div>
                <!-- 实时预览区域 -->
                <div class="realtime-preview">
                    <h3>实时预览</h3>
                    <div id="realtimePreviewContainer" class="preview-container">
                        <div id="realtimePreviewContent" class="preview-content">
                            <div class="preview-header">
                                <div class="preview-title"></div>
                            </div>
                            <div class="preview-body">
                                <p>这是预览内容...</p>
                            </div>
                            <div class="preview-footer">
                                <div class="preview-author">作者: <span id="previewAuthorDisplay"></span></div>
                                <div class="preview-generated-by" style="margin-top: 10px; padding-top: 5px; text-align: center; font-style: normal; font-size: 12px; opacity: 0.7; font-family: 'Source Han Sans', 'Noto Sans CJK', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;">由 饸饹随笔 生成</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 隐私条款模态框 -->
    <div id="privacyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>隐私声明</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="privacy-content">
                    <p>我们尊重并保护用户隐私，现就相关事项声明如下：</p>
                    <h3>数据收集</h3>
                    <p>我们不收集用户使用编辑器时的输入内容、字体/字号/背景等配置偏好，不获取任何个人身份信息。</p>
                    <h3>数据使用</h3>
                    <p>我们不收集用于提供编辑、预览等核心服务的任何信息。</p>
                    <h3>数据安全</h3>
                    <p>我们采取必要技术措施保护数据，防止泄露、篡改或丢失；用户输入内容的所有权归用户所有，我们不存储或滥用。</p>
                    <h3>第三方披露</h3>
                    <p>我们不保存、收集任何用户数据。</p>
                    <h3>权利说明</h3>
                    <p>用户可随时删除编辑内容，因为数据在本地缓存，删除后无法恢复。</p>
                    <h3>条款更新</h3>
                    <p>本声明可能适时调整，更新后将在网站公示，继续使用服务即视为认可新条款。</p>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="script.js"></script>
</body>
</html>